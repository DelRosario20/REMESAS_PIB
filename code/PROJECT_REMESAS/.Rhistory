addshade = c("negative", "positive", "all"),
shade.lwd = 1,
shade.col = "white",
transKeepSign = TRUE,
p.mat = NULL,
sig.level = 0.05,
insig = c("pch", "p-value", "blank", "n", "label_sig"),
pch = 4,
pch.col = "black",
pch.cex = 3,
plotCI = c("n", "square", "circle", "rect"),
lowCI.mat = NULL,
uppCI.mat = NULL,
na.label = "?",
na.label.col = "black",
win.asp = 1)
corrplot.mixed(Matriz_Correl)
plot(Matriz_Correl)
#Grafico de matriz de correlacion
corrplot(Matriz_Correl)
print(Matriz_Correl)
ggplot(cor_melt, aes(x = Var1, y = Var2, fill = value)) +
geom_tile() +
scale_fill_gradient2(low = "red", high = "blue", mid = "white", midpoint = 0, limit = c(-1, 1)) +
theme_minimal() +
labs(title = "Matriz de Correlación", x = "", y = "") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Linea de tiempo para las REMESAS
ggplot(data = datos, aes(x = TIEMPO, y = REMESAS)) +
geom_line(color = "blue", size = 1.2) +    # Línea azul
geom_point(color = "red", size = 3) +      # Puntos rojos
labs(title = "Evolución de las remesas",
x = "Año",
y = "Gasto Público (en millones)") +
theme_minimal() +                          # Tema visual minimalista
theme()
# Data --------------------------------------------------------------------
{
# Librería
library(readxl)
library(tidyverse)
library(lubridate)
library(scales)
library(tidyverse)
library(ggplot2)
library(fdth)
library(knitr)
library(dplyr)
library(fdth)
library(e1071)
library(haven)
library(corrplot)
library(reshape2)
library(modelsummary)
library(pandoc)
library(stargazer)
library(devtools)
library(usethis)
library(sjPlot)
}
datos <- read_excel("C:/Users/USER/Documents/REMESAS_PIB/data/amplia/CIFRAS_PROJECT_AMPLIA.xlsx")
# Linea de tiempo para las REMESAS
ggplot(data = datos, aes(x = TIEMPO, y = REMESAS)) +
geom_line(color = "blue", size = 1.2) +    # Línea azul
geom_point(color = "red", size = 3) +      # Puntos rojos
labs(title = "Evolución de las remesas",
x = "Año",
y = "Gasto Público (en millones)") +
theme_minimal() +                          # Tema visual minimalista
theme()
View(datos)
df$TIEMPO <- as.Date(paste0(df$TIEMPO))
df$TIEMPO <- as.Date(paste0(df$TIEMPO, "-01-01"))
df$TIEMPO <- as.numeric(df$TIEMPO)
datos$TIEMPO <- as.numeric(datos$TIEMPO)
library(zoo)
df$TIEMPO <- as.yearqtr(df$TIEMPO, format = "%Y")
dato$TIEMPO <- as.yearqtr(datos$TIEMPO, format = "%Y")
datos$TIEMPO <- as.yearqtr(datos$TIEMPO, format = "%Y")
view(datos)
# Linea de tiempo para las REMESAS
ggplot(data = datos, aes(x = TIEMPO, y = REMESAS)) +
geom_line(color = "blue", size = 1.2) +    # Línea azul
geom_point(color = "red", size = 3) +      # Puntos rojos
labs(title = "Evolución de las remesas",
x = "Año",
y = "Gasto Público (en millones)") +
theme_minimal() +                          # Tema visual minimalista
theme()
datos <- read_excel("C:/Users/USER/Documents/REMESAS_PIB/data/amplia/CIFRAS_PROJECT_AMPLIA.xlsx")
datos$TIEMPO <- as.numeric(datos$TIEMPO)
View(datos)
# Linea de tiempo para las REMESAS
ggplot(data = datos, aes(x = TIEMPO, y = REMESAS)) +
geom_line(color = "blue", size = 1.2) +    # Línea azul
geom_point(color = "red", size = 3) +      # Puntos rojos
labs(title = "Evolución de las remesas",
x = "Año",
y = "Gasto Público (en millones)") +
theme_minimal() +                          # Tema visual minimalista
theme()
View(datos)
datos$TIEMPO <- as.yearqtr(datos$TIEMPO, format = "")
View(datos)
# Linea de tiempo para las REMESAS
ggplot(data = datos, aes(x = TIEMPO, y = REMESAS)) +
geom_line(color = "blue", size = 1.2) +    # Línea azul
geom_point(color = "red", size = 3) +      # Puntos rojos
labs(title = "Evolución de las remesas",
x = "Año",
y = "Gasto Público (en millones)") +
theme_minimal() +                          # Tema visual minimalista
theme()
datos$TIEMPO <- as.numeric(datos$TIEMPO)
datos$TIEMPO <- as.yearqtr(datos$TIEMPO)
View(datos)
datos$TIEMPO <- as.Date(datos$TIEMPO)
View(datos)
# Linea de tiempo para las REMESAS
ggplot(data = datos, aes(x = TIEMPO, y = REMESAS)) +
geom_line(color = "blue", size = 1.2) +    # Línea azul
geom_point(color = "red", size = 3) +      # Puntos rojos
labs(title = "Evolución de las remesas",
x = "Año",
y = "Gasto Público (en millones)") +
theme_minimal() +                          # Tema visual minimalista
theme()
datos$PIB <- as.numeric(datos$PIB)
View(datos)
# Linea de tiempo para las REMESAS
ggplot(data = datos, aes(x = TIEMPO, y = REMESAS)) +
geom_line(color = "blue", size = 1.2) +    # Línea azul
geom_point(color = "red", size = 3) +      # Puntos rojos
labs(title = "Evolución de las remesas",
x = "Año",
y = "Gasto Público (en millones)") +
theme_minimal() +                          # Tema visual minimalista
theme()
modelo_basico <- lm(PIB ~ CONSUMO + GASTO_PUBLICO + INVERSION + EXPORTA_NETAS, data = datos)
summary(modelo_basico)
# Visualización de la relación
# Visualización de la relación entre REMESAS y CONSUMO
ggplot(datos, aes(x = CONSUMO, y = PIB)) +
geom_point() +
geom_smooth(method = "lm", col = "blue") +
labs(title = "Impacto de las REMESAS en el CONSUMO", x = "Remesas", y = "Consumo")
# Visualización de la relación entre CONSUMO_AJUSTADO y PIB
ggplot(datos, aes(x = consumo_ajustado, y = PIB)) +
geom_point() +
geom_smooth(method = "lm", col = "blue") +
labs(title = "Impacto de las CONSUMO_AJUSTADO en el PIB", x = "Consumo_ajustado", y = "PIB")
# Visualización de la relación entre CONSUMO_AJUSTADO y PIB
ggplot(datos, aes(x = consumo_ajustado, y = PIB)) +
geom_point() +
geom_smooth(method = "lm", col = "blue") +
labs(title = "Impacto de las CONSUMO_AJUSTADO en el PIB", x = "consumo_ajustado", y = "PIB")
View(datos)
# Regresión en dos etapas -------------------------------------------------
# Etapa 1: Ajustar el modelo de regresión para consumo
modelo_etapa1 <- lm(CONSUMO ~ REMESAS, data = datos)
# Extraer los valores ajustados (consumo estimado a partir de remesas)
datos$consumo_ajustado <- modelo_etapa1$fitted.values
modelo_indice_pib <- lm(PIB ~ consumo_ajustado + GASTO_PUBLICO + INVERSION + EXPORTA_NETAS, data = datos)
# Visualización de la relación entre CONSUMO_AJUSTADO y PIB
ggplot(datos, aes(x = consumo_ajustado, y = PIB)) +
geom_point() +
geom_smooth(method = "lm", col = "blue") +
labs(title = "Impacto de las CONSUMO_AJUSTADO en el PIB", x = "consumo_ajustado", y = "PIB")
# Visualización de la relación
# Visualización de la relación entre REMESAS y CONSUMO
ggplot(datos, aes(x = CONSUMO, y = PIB)) +
geom_point() +
geom_smooth(method = "lm", col = "blue") +
labs(title = "Impacto de las REMESAS en el CONSUMO", x = "Consumo", y = "PIB")
# Visualización de la relación entre CONSUMO_AJUSTADO y PIB
ggplot(datos, aes(x = consumo_ajustado, y = PIB)) +
geom_point() +
geom_smooth(method = "lm", col = "blue") +
labs(title = "Impacto de las CONSUMO_AJUSTADO en el PIB", x = "consumo_ajustado", y = "PIB")
summary(datos$consumo_ajustado)
summary(datos$CONSUMO)
# Visualización de la relación entre CONSUMO_AJUSTADO y PIB
ggplot(datos, aes(x = consumo_ajustado, y = PIB)) +
geom_point() +
geom_smooth(method = "lm", col = "blue") +
labs(title = "Impacto de las Consumo ajustado por remesas en el PIB", x = "consumo_ajustado", y = "PIB")
# Visualización de la relación entre CONSUMO_AJUSTADO y PIB
ggplot(datos, aes(x = consumo_ajustado, y = PIB)) +
geom_point() +
geom_smooth(method = "lm", col = "blue") +
labs(title = "Impacto de las Consumo ajustado por remesas en el PIB", x = "Consumo ajustado", y = "PIB")
# Visualización de la relación entre CONSUMO_AJUSTADO y PIB
ggplot(datos, aes(x = PIB, y = consumo_ajustado)) +
geom_point() +
geom_smooth(method = "lm", col = "blue") +
labs(title = "Impacto de las Consumo ajustado por remesas en el PIB", x = "PIB", y = "Consumo ajustado")
# Visualización de la relación entre CONSUMO_AJUSTADO y PIB
ggplot(datos, aes(x = consumo_ajustado, y = PIB)) +
geom_point() +
geom_smooth(method = "lm", col = "blue") +
labs(title = "Impacto de las Consumo ajustado por remesas en el PIB", x = "Consumo ajustado", y = "PIB")
# Visualización de la relación
# Visualización de la relación entre REMESAS y CONSUMO
ggplot(datos, aes(x = CONSUMO, y = PIB)) +
geom_point() +
geom_smooth(method = "lm", col = "blue") +
labs(title = "Impacto de las REMESAS en el CONSUMO", x = "Consumo", y = "PIB")
# Visualización de la relación entre CONSUMO_AJUSTADO y PIB
ggplot(datos, aes(x = consumo_ajustado, y = PIB)) +
geom_point() +
geom_smooth(method = "lm", col = "blue") +
labs(title = "Impacto de las Consumo ajustado por remesas en el PIB", x = "Consumo ajustado", y = "PIB")
**Orientador/a:**\\
---
title: "Contribución de las Remesas al Consumo y su Impacto en el Crecimiento Económico del Ecuador entre 2015 y 2022"
# Data --------------------------------------------------------------------
{
# Librería
library(readxl)
library(tidyverse)
library(lubridate)
library(scales)
library(tidyverse)
library(ggplot2)
library(fdth)
library(knitr)
library(dplyr)
library(fdth)
library(e1071)
library(haven)
library(corrplot)
library(reshape2)
library(modelsummary)
library(pandoc)
library(stargazer)
library(devtools)
library(usethis)
library(sjPlot)
library(zoo)
}
datos$TIEMPO <- as.Date(datos$TIEMPO)
# Regresión en dos etapas -------------------------------------------------
# Etapa 1: Ajustar el modelo de regresión para consumo
modelo_etapa1 <- lm(CONSUMO ~ REMESAS, data = datos)
# Extraer los valores ajustados (consumo estimado a partir de remesas)
datos$consumo_ajustado <- modelo_etapa1$fitted.values
EXPORTA_NETAS <- datos$EXPORTACIONES-datos$IMPORTACIONES
modelo_indice_pib <- lm(PIB ~ consumo_ajustado + GASTO_PUBLICO + INVERSION + EXPORTA_NETAS, data = datos)
summary(modelo_indice_pib)
summary(modelo_basico)
# Data --------------------------------------------------------------------
{
# Librería
library(readxl)
library(tidyverse)
library(lubridate)
library(scales)
library(tidyverse)
library(ggplot2)
library(fdth)
library(knitr)
library(dplyr)
library(fdth)
library(e1071)
library(haven)
library(corrplot)
library(reshape2)
library(modelsummary)
library(pandoc)
library(stargazer)
library(devtools)
library(usethis)
library(sjPlot)
library(zoo)
}
datos <- read_dta("data/amplia/CIFRAS_PROJECT_AMPLIA.xlsx")
datos <- read_excel("C:/Users/USER/Documents/REMESAS_PIB/data/amplia/CIFRAS_PROJECT_AMPLIA.xlsx")
datos$TIEMPO <- as.Date(datos$TIEMPO)
# Regresión en dos etapas -------------------------------------------------
# Etapa 1: Ajustar el modelo de regresión para consumo
modelo_etapa1 <- lm(CONSUMO ~ REMESAS, data = datos)
# Extraer los valores ajustados (consumo estimado a partir de remesas)
datos$consumo_ajustado <- modelo_etapa1$fitted.values
# Etapa 2: Ajustar el modelo de regresión para el PIB usando el consumo ajustado
modelo_etapa2 <- lm(PIB ~ consumo_ajustado, data = datos)
EXPORTA_NETAS <- datos$EXPORTACIONES-datos$IMPORTACIONES
modelo_basico <- lm(PIB ~ CONSUMO + GASTO_PUBLICO + INVERSION + EXPORTA_NETAS, data = datos)
modelo_indice_pib <- lm(PIB ~ consumo_ajustado + GASTO_PUBLICO + INVERSION + EXPORTA_NETAS, data = datos)
# Ver los resultados del modelo final
summary(modelo_etapa1)
summary(modelo_etapa2)
summary(modelo_basico)
summary(modelo_indice_pib)
# Regresión en dos etapas -------------------------------------------------
# Etapa 1: Ajustar el modelo de regresión para consumo
modelo_etapa1 <- lm(CONSUMO ~ REMESAS, data = datos)
# Ver los resultados del modelo final
summary(modelo_etapa1)
# Exportar modelo a LaTeX, HTML o texto
stargazer(modelo_etapa1, modelo_indice_pib,
type = "text",
title = "Resultados de las Regresiones en Dos Etapas",
align = TRUE,
dep.var.labels = c("Consumo Ajustado", "PIB"),
covariate.labels = c("Remesas", "Consumo Ajustado"),
out = "resultados_regresion1.html")  # Cambiar extensión según formato
# Crear tabla para los modelos y exportarla a Word
tab_model(modelo_etapa1, modelo_indice_pib,
title = "Resultados de las Regresiones",
dv.labels = c("Consumo", "PIB"),
show.ci = FALSE,
show.se = TRUE,  # Muestra errores estándar
file = "resultados_regresion2.doc")  # Exporta a Word
# Cargar librerías necesarias
library(knitr)
# Definir los datos de la tabla
data <- data.frame(
Variable = c("Remesas", "Consumo Ajustado", "GASTO_PUBLICO", "INVERSION", "EXPORTA_NETAS", "Constante"),
`Consumo Ajustado` = c("5.240***", "", "", "", "", "47,713,158.000***"),
`Error Consumo Ajustado` = c("(1.676)", "", "", "", "", "(5,191,758.000)"),
PIB = c("", "0.855***", "4.092***", "0.161", "-0.977", "-18,017,905.000"),
`Error PIB` = c("", "(0.179)", "(0.346)", "(0.144)", "(0.581)", "(11,485,484.000)")
)
# Crear la tabla sin kableExtra para evitar el uso de tabu
kable(data, align = "c", col.names = c("Variable", "Consumo Ajustado", "(Error Estándar)", "PIB", "(Error Estándar)"))
datos$log_CONSUMO <- log(datos$CONSUMO)
datos$log_REMESAS <- log(datos$REMESAS)
datos$log_PIB <- log(datos$PIB)
datos$log_GASTO_PUBLICO <- log(datos$GASTO_PUBLICO)
datos$log_INVERSION <- log(datos$INVERSION)
datos$log_EXPORTA_NETAS <- log(datos$EXPORTA_NETAS)
EXPORTA_NETAS <- datos$EXPORTACIONES-datos$IMPORTACIONES
# Transformar las variables de consumo y remesas a logaritmo
datos$log_CONSUMO <- log(datos$CONSUMO)
datos$log_REMESAS <- log(datos$REMESAS)
datos$log_PIB <- log(datos$PIB)
datos$log_GASTO_PUBLICO <- log(datos$GASTO_PUBLICO)
datos$log_INVERSION <- log(datos$INVERSION)
datos$log_EXPORTA_NETAS <- log(datos$EXPORTA_NETAS)
View(datos)
datos$EXPORTA_NETAS <- datos$EXPORTACIONES-datos$IMPORTACIONES
View(datos)
view(datos$EXPORTA_NETAS)
EXPORTA_NETAS <- datos$EXPORTACIONES-datos$IMPORTACIONES
min_exporta_neta <- min(datos$EXPORTA_NETAS)
shift_value <- abs(min_exporta_neta) + 1  # Añadir 1 para evitar log(0)
datos$log_EXPORTA_NETAS <- log(datos$EXPORTA_NETAS + shift_value)
datos$log_CONSUMO <- log(datos$CONSUMO)
datos$log_REMESAS <- log(datos$REMESAS)
datos$log_PIB <- log(datos$PIB)
datos$log_GASTO_PUBLICO <- log(datos$GASTO_PUBLICO)
datos$log_INVERSION <- log(datos$INVERSION)
datos$log_EXPORTA_NETAS <- sign(datos$EXPORTA_NETAS) * log(abs(datos$EXPORTA_NETAS) + 1)
# Regresión en dos etapas -------------------------------------------------
# Etapa 1: Ajustar el modelo de regresión para consumo
modelo_etapa1 <- lm(log_CONSUMO ~ log_REMESAS, data = datos)
# Extraer los valores ajustados (consumo estimado a partir de remesas)
datos$consumo_ajustado <- exp(modelo_etapa1$fitted.values)
modelo_indice_pib <- lm(log_PIB ~ log(consumo_ajustado) + log_GASTO_PUBLICO + log_INVERSION + log_EXPORTA_NETAS, data = datos)
# Ver los resultados del modelo final
summary(modelo_etapa1)
summary(modelo_indice_pib)
# Visualización de la relación
# Visualización de la relación entre REMESAS y CONSUMO
ggplot(datos, aes(x = CONSUMO, y = PIB)) +
geom_point() +
geom_smooth(method = "lm", col = "blue") +
labs(title = "Impacto de las REMESAS en el CONSUMO", x = "Consumo", y = "PIB")
# Visualización de la relación entre CONSUMO_AJUSTADO y PIB
ggplot(datos, aes(x = consumo_ajustado, y = PIB)) +
geom_point() +
geom_smooth(method = "lm", col = "blue") +
labs(title = "Impacto de las Consumo ajustado por remesas en el PIB", x = "Consumo ajustado", y = "PIB")
modelo_indice_pib <- lm(log_PIB ~ log(consumo_ajustado) + log_GASTO_PUBLICO + log_INVERSION + log_EXPORTA_NETAS, data = datos)
# Pruea de colinealidad (Prueba VIF) para el modelo de la etapa 2
vif(modelo_indice_pib)
# Data --------------------------------------------------------------------
{
# Librería
library(readxl)
library(tidyverse)
library(lubridate)
library(scales)
library(tidyverse)
library(ggplot2)
library(fdth)
library(knitr)
library(dplyr)
library(fdth)
library(e1071)
library(haven)
library(corrplot)
library(reshape2)
library(modelsummary)
library(pandoc)
library(stargazer)
library(devtools)
library(usethis)
library(sjPlot)
library(zoo)
library(car)
library(lmtest)
}
install.packages("lmtest")
# Data --------------------------------------------------------------------
{
# Librería
library(readxl)
library(tidyverse)
library(lubridate)
library(scales)
library(tidyverse)
library(ggplot2)
library(fdth)
library(knitr)
library(dplyr)
library(fdth)
library(e1071)
library(haven)
library(corrplot)
library(reshape2)
library(modelsummary)
library(pandoc)
library(stargazer)
library(devtools)
library(usethis)
library(sjPlot)
library(zoo)
library(car)
library(lmtest)
}
# Pruea de colinealidad (Prueba VIF) para el modelo de la etapa 2
vif(modelo_indice_pib)
# Para el modelo 2
dwtest(modelo_indice_pib)
# Prueba el omdelo de la etapa 2
bptest(modelo_indice_pib)
# Pruea de colinealidad (Prueba VIF) para el modelo de la etapa 2
vif(modelo_indice_pib)
# Prueba el omdelo de la etapa 2
bptest(modelo_indice_pib)
# Para el modelo 2
dwtest(modelo_indice_pib)
# Prueba el omdelo de la etapa 2
bptest(modelo_indice_pib)
# Para el modelo 2
dwtest(modelo_indice_pib)
datos <- read_excel("C:/Users/USER/Documents/REMESAS_PIB/data/amplia/CIFRAS_PROJECT_AMPLIA.xlsx")
# Limpieza de datos
datos$TIEMPO <- as.Date(datos$TIEMPO)
EXPORTA_NETAS <- datos$EXPORTACIONES-datos$IMPORTACIONES
min_exporta_neta <- min(datos$EXPORTA_NETAS)
shift_value <- abs(min_exporta_neta) + 1  # Añadir 1 para evitar log(0)
# Transformar las variables de consumo y remesas a logaritmo
datos$log_CONSUMO <- log(datos$CONSUMO)
datos$log_REMESAS <- log(datos$REMESAS)
datos$log_PIB <- log(datos$PIB)
datos$log_GASTO_PUBLICO <- log(datos$GASTO_PUBLICO)
datos$log_INVERSION <- log(datos$INVERSION)
datos$log_EXPORTA_NETAS <- log(datos$EXPORTA_NETAS + shift_value)
EXPORTA_NETAS <- datos$EXPORTACIONES-datos$IMPORTACIONES
min_exporta_neta <- min(datos$EXPORTA_NETAS)
datos$EXPORTA_NETAS <- datos$EXPORTACIONES-datos$IMPORTACIONES
min_exporta_neta <- min(datos$EXPORTA_NETAS)
shift_value <- abs(min_exporta_neta) + 1  # Añadir 1 para evitar log(0)
# Transformar las variables de consumo y remesas a logaritmo
datos$log_CONSUMO <- log(datos$CONSUMO)
datos$log_REMESAS <- log(datos$REMESAS)
datos$log_PIB <- log(datos$PIB)
datos$log_GASTO_PUBLICO <- log(datos$GASTO_PUBLICO)
datos$log_INVERSION <- log(datos$INVERSION)
datos$log_EXPORTA_NETAS <- log(datos$EXPORTA_NETAS + shift_value)
# Regresión en dos etapas -------------------------------------------------
# Etapa 1: Ajustar el modelo de regresión para consumo
modelo_etapa1 <- lm(log_CONSUMO ~ log_REMESAS, data = datos)
# Extraer los valores ajustados (consumo estimado a partir de remesas)
datos$consumo_ajustado <- exp(modelo_etapa1$fitted.values)
modelo_indice_pib <- lm(log_PIB ~ log(consumo_ajustado) + log_GASTO_PUBLICO + log_INVERSION + log_EXPORTA_NETAS, data = datos)
# Ver los resultados del modelo final
summary(modelo_etapa1)
summary(modelo_indice_pib)
datos <- read_excel("C:/Users/USER/Documents/REMESAS_PIB/data/amplia/CIFRAS_PROJECT_AMPLIADO.xlsx")
{
# Librería
library(readxl)
library(tidyverse)
library(lubridate)
library(scales)
library(tidyverse)
library(ggplot2)
library(fdth)
library(knitr)
library(dplyr)
library(fdth)
library(e1071)
library(haven)
library(corrplot)
library(reshape2)
library(modelsummary)
library(pandoc)
library(stargazer)
library(devtools)
library(usethis)
library(sjPlot)
library(zoo)
library(car)
library(lmtest)
}
datos <- read_excel("C:/Users/USER/Documents/REMESAS_PIB/data/amplia/CIFRAS_PROJECT_AMPLIADO.xlsx")
# Limpieza de datos
datos$TIEMPO <- as.Date(datos$TIEMPO)
View(datos)
